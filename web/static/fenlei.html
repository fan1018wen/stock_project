
<div ng-controller='fenleiCtrl' class="container">

	<div class="row">

		<form class="form-inline" role="form">
			<button type="submit" class="btn btn-default" ng-click="showFenlei=!showFenlei">
				显示/隐藏分类
			</button>
			<div class="form-group">
				<input type="text" ng-model="fenleiSearch" class="form-control"  placeholder="搜索分类">
			</div>
			<div class="form-group">
				<input type="text" ng-model="CompanySearch" class="form-control" ng-change="searchCompany()" placeholder="搜索公司">
			</div>
			{{CompanySearch}}
		</form>
		<!--分类列表-->
		<div class="col-md-12 thumbnail fenlei" ng-show="showFenlei || fenleiSearch">
			<span ng-repeat="i in fenleiList | filter:fenleiSearch" ng-click="clickFenlei($index)"> {{i.name}}({{i.count}}) </span>
		</div>
		
	</div>
	<h3>公司</h3>
	<div class="company row thumbnail ">
		<span ng-repeat='i in company.id_list'>{{i}} {{company.title_list[$index]}}</span>
	</div>
</div>

<div ng-controller="reloadCtrl"></div>
<script type="text/javascript" charset="utf-8">
	function reloadCtrl($http, $route) {
		var oldHtml = '';
		var reload = function(url) {
			$http.get(url).success(function(newHtml) {
				if (oldHtml.length > 0 && newHtml != oldHtml) {
					clearInterval(id);
					$route.reload();
				} else {
					oldHtml = newHtml;
					//					console.log('watch')
				}
			});
		};
		var reloadList = function() {
			reload('/static/fenlei.html');

		}
		var id = setInterval(reloadList, 300);
	}

</script>

